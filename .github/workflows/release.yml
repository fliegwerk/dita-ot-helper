name: Release and Publish

on:
  workflow_dispatch:
    inputs:
      releaseType:
        description: 'Release Type (major|minor|patch)'
        required: true
        default: 'patch'

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - run: git checkout master
    - name: Set up JDK 1.8
      uses: actions/setup-java@v1
      with:
        java-version: 1.8
    - uses: actions/setup-node@v1
      with:
        node-version: 12
    - run: |
        git config --local user.email "contact@pabloklaschka.de"
        git config --local user.name "Release Action"
    - run: npm ci
    - name: Linting
      run: npm run lint
    - run: |
        npm version ${{ github.event.inputs.releaseType }}
        git push
        git push --tags
